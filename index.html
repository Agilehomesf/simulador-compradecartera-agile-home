<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Simulador de Compra de Cartera Hipotecaria - Agile Home</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
  <!-- Header -->
  <header>
    <div class="container">
      <div class="row align-items-center">
        <div class="col-lg-8">
          <h1 class="header-title">
            <i class="bi bi-house-door-fill me-3"></i>
            Simulador de Compra de Cartera Hipotecaria
          </h1>
          <p class="header-subtitle">
            Descubre cuánto puedes ahorrar al trasladar tu hipoteca a otro banco
          </p>
        </div>
        <div class="col-lg-4 text-end">
          <div class="text-white">
            <i class="bi bi-shield-check" style="font-size: 2rem;"></i>
            <div class="mt-2">
              <small>Simulaciones 100% gratuitas</small>
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <div class="container my-5">
    
    <!-- Introduction -->
    <div class="intro-container">
      <div class="row">
        <div class="col-lg-8">
          <div class="d-flex align-items-center mb-4">
            <i class="bi bi-arrow-left-right intro-icon me-3"></i>
            <div>
              <h2 class="mb-2">¿Cómo funciona la Compra de Cartera?</h2>
              <p class="mb-0">Transfiere tu hipoteca actual a un nuevo banco con mejores condiciones y ahorra dinero cada mes.</p>
            </div>
          </div>
          
          <div class="row">
            <div class="col-md-4 text-center mb-3">
              <i class="bi bi-calculator intro-icon"></i>
              <h5>Calcula tu ahorro</h5>
              <p class="small">Compara las condiciones actuales vs las nuevas ofertas del mercado</p>
            </div>
            <div class="col-md-4 text-center mb-3">
              <i class="bi bi-bank intro-icon"></i>
              <h5>Múltiples bancos</h5>
              <p class="small">Compara ofertas de los principales bancos del país</p>
            </div>
            <div class="col-md-4 text-center mb-3">
              <i class="bi bi-piggy-bank intro-icon"></i>
              <h5>Ahorra dinero</h5>
              <p class="small">Reduce tu cuota mensual y ahorra miles de pesos</p>
            </div>
          </div>
        </div>
        <div class="col-lg-4 position-relative">
          <i class="bi bi-house-fill house-icon-large"></i>
        </div>
      </div>
    </div>

    <!-- Calculator Form -->
    <div class="card">
      <div class="card-header">
        <h3 class="mb-0">
          <i class="bi bi-calculator-fill me-2"></i>
          Datos de tu Hipoteca Actual
        </h3>
      </div>
      <div class="card-body">
        <form id="calculatorForm">
          <div class="row">
            <div class="col-md-6 mb-3">
              <label for="property_value" class="form-label">Valor del Inmueble</label>
              <div class="input-group">
                <span class="input-group-text">$</span>
                <input type="number" class="form-control" id="property_value" name="property_value" required>
              </div>
            </div>
            <div class="col-md-6 mb-3">
              <label for="portfolio_balance" class="form-label">Saldo de la Cartera a Comprar</label>
              <div class="input-group">
                <span class="input-group-text">$</span>
                <input type="number" class="form-control" id="portfolio_balance" name="portfolio_balance" required>
              </div>
            </div>
          </div>
          
          <div class="row">
            <div class="col-md-6 mb-3">
              <label for="initial_term" class="form-label">Plazo Inicial de la Deuda (meses)</label>
              <input type="number" class="form-control" id="initial_term" name="initial_term" required>
            </div>
            <div class="col-md-6 mb-3">
              <label for="remaining_term" class="form-label">Plazo Restante (meses)</label>
              <input type="number" class="form-control" id="remaining_term" name="remaining_term" required>
            </div>
          </div>
          
          <div class="row">
            <div class="col-md-6 mb-3">
              <label for="current_rate" class="form-label">Tasa Efectiva Anual Actual (%)</label>
              <div class="input-group">
                <input type="number" step="0.01" class="form-control" id="current_rate" name="current_rate" required>
                <span class="input-group-text">%</span>
              </div>
            </div>
            <div class="col-md-6 mb-3">
              <label for="insurance_value" class="form-label">Valor Total de los Seguros</label>
              <div class="input-group">
                <span class="input-group-text">$</span>
                <input type="number" class="form-control" id="insurance_value" name="insurance_value" required>
              </div>
            </div>
          </div>
          
          <div class="row">
            <div class="col-md-6 mb-3">
              <label for="new_term" class="form-label">Plazo de la Compra de Cartera (meses)</label>
              <input type="number" class="form-control" id="new_term" name="new_term" required>
            </div>
          </div>
        </form>
      </div>
    </div>

    <!-- Bank Selection -->
    <div class="card">
      <div class="card-header">
        <h3 class="mb-0">
          <i class="bi bi-bank2 me-2"></i>
          Selecciona los Bancos a Comparar
        </h3>
      </div>
      <div class="card-body">
        <div class="bank-options">
          <button type="button" class="select-all-option" onclick="selectAllBanks()">
            <i class="bi bi-check-all me-2"></i>
            Seleccionar Todos los Bancos
          </button>
          
          {% for bank_key, bank in banks.items() %}
          <div class="bank-option" data-bank="{{ bank_key }}">
            <input type="checkbox" class="form-check-input me-2" id="bank_{{ bank_key }}" name="selected_banks" value="{{ bank_key }}">
            <i class="{{ bank.icon }}"></i>
            <div>
              <strong>{{ bank.name }}</strong>
              <div class="small text-muted">
                {% if bank_key == 'banco_bogota' %}
                  Desde {{ bank.rates.campaign }}% (campaña) hasta {{ bank.rates.max }}%
                {% elif bank_key == 'bbva' %}
                  VIS: {{ bank.rates.vis_min }}% - {{ bank.rates.vis_max }}% | No VIS: desde {{ bank.rates.no_vis_min }}%
                {% else %}
                  Desde {{ bank.rates.min }}% hasta {{ bank.rates.max }}%
                {% endif %}
              </div>
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
    </div>

    <!-- Calculate Button -->
    <div class="text-center my-4">
      <button type="button" class="btn btn-primary btn-lg" onclick="calculatePortfolio()">
        <i class="bi bi-calculator me-2"></i>
        Calcular Ahorro Potencial
      </button>
    </div>

    <!-- Results Section -->
    <div id="resultsSection" class="d-none">
      <div class="card">
        <div class="card-header">
          <h3 class="mb-0">
            <i class="bi bi-graph-up me-2"></i>
            Resultados de la Simulación
          </h3>
        </div>
        <div class="card-body">
          <div id="resultsContainer">
            <!-- Results will be populated here -->
          </div>
        </div>
      </div>
    </div>

    <!-- Important Information -->
    <div class="info-important">
      <div class="text-center">
        <i class="bi bi-info-circle-fill" style="font-size: 3rem; margin-bottom: 1rem;"></i>
        <h4>¿Necesitas Asesoría Personalizada?</h4>
        <p>Nuestros expertos en crédito hipotecario están listos para ayudarte a encontrar la mejor opción para tu compra de cartera.</p>
        <button class="btn btn-success whatsapp-btn" onclick="contactWhatsApp()">
          <i class="bi bi-whatsapp me-2"></i>
          Contactar por WhatsApp
        </button>
      </div>
    </div>

  </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="row">
        <div class="col-md-6">
          <h5>Agile Home</h5>
          <p>Tu aliado en el camino hacia la casa de tus sueños</p>
          <ul class="list-unstyled">
            <li>• Simulaciones gratuitas y sin compromiso</li>
            <li>• Asesoría personalizada</li>
            <li>• Comparación de múltiples bancos</li>
            <li>• Proceso 100% digital</li>
          </ul>
        </div>
        <div class="col-md-6">
          <h5>Información Importante</h5>
          <p class="small">
            Los resultados de esta simulación son referenciales y pueden variar según las condiciones específicas de cada banco y cliente. 
            Las tasas de interés están sujetas a cambios y aprobación crediticia. 
            Las tarifas de los seguros pueden cambiar según la entidad financiera seleccionada.
            Para obtener información exacta, consulta a tu asesor Agile Home.
          </p>
        </div>
      </div>
      <hr class="my-4">
      <div class="text-center">
        <p class="mb-0">&copy; 2025 Agile Home. Todos los derechos reservados.</p>
      </div>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="{{ url_for('static', filename='js/calculator.js') }}"></script>
</body>
</html>
